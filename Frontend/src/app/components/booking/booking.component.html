<div class="booking-container" *ngIf="!bookingConfirmation">
  <!-- Seat Legend -->
  <div class="seat-legend-header">
    <div class="legend-item">
      <div class="seat-icon booked-m"></div>
      <span class="legend-label">BOOKED (M)</span>
    </div>
    <div class="legend-item">
      <div class="seat-icon booked-f"></div>
      <span class="legend-label">BOOKED (F)</span>
    </div>
    <div class="legend-item">
      <div class="seat-icon blocked"></div>
      <span class="legend-label">BLOCKED</span>
    </div>
    <div class="legend-item">
      <div class="seat-icon available"></div>
      <span class="legend-label">AVAILABLE</span>
    </div>
    <div class="legend-item">
      <div class="seat-icon selected"></div>
      <span class="legend-label">SELECTED</span>
    </div>
    <div class="legend-item">
      <div class="seat-icon sold-m"></div>
      <span class="legend-label">SOLD (M)</span>
    </div>
    <div class="legend-item">
      <div class="seat-icon sold-f"></div>
      <span class="legend-label">SOLD (F)</span>
    </div>
  </div>

  <div class="booking-content">
    <!-- Left Side: Seat Selection -->
    <div class="seat-selection-panel">
      <div class="bus-layout">
        <div class="bus-front">
          <div class="steering-wheel">ðŸšŒ</div>
        </div>

        <div class="seat-grid">
          <div 
            *ngFor="let seat of generateSeats()" 
            class="seat-wrapper"
            [class.empty]="!seat">
            <div 
              *ngIf="seat"
              class="seat"
              [class.selected]="isSeatSelected(seat)"
              [class.booked]="isSeatBooked(seat)"
              [class.available]="!isSeatBooked(seat) && !isSeatSelected(seat)"
              (click)="toggleSeat(seat)">
            </div>
          </div>
        </div>
      </div>
    </div>

    <!-- Right Side: Booking Details -->
    <div class="booking-details-panel">
      <!-- Boarding/Dropping Point Section -->
      <div class="boarding-dropping-section">
        <div class="section-header">
          <span class="header-title">BOARDING/DROPPING:</span>
          <span class="header-subtitle">BOARDING POINT*</span>
        </div>
        
        <select [(ngModel)]="boardingPoint" name="boardingPoint" class="dropdown">
          <option value="">Select boarding point</option>
          <option value="Kallyanpur">[06:00 AM] Kallyanpur counter</option>
          <option value="Baneshore">[10:30 AM] Baneshore Counter</option>
          <option value="Rajshahi">[11:30 PM] Rajshahi Counter</option>
          <option value="Rajabari">[03:00 PM] Rajabari Counter</option>
        </select>

        <div class="section-header" style="margin-top: 20px;">
          <span class="header-subtitle">DROPPING POINT*</span>
        </div>
        
        <select [(ngModel)]="droppingPoint" name="droppingPoint" class="dropdown">
          <option value="">Select dropping point</option>
          <option value="Kallyanpur">[06:00 AM] Kallyanpur counter</option>
          <option value="Baneshore">[10:30 AM] Baneshore Counter</option>
          <option value="Rajshahi">[11:30 PM] Rajshahi Counter</option>
          <option value="Rajabari">[03:00 PM] Rajabari Counter</option>
        </select>

        <!-- Price Breakdown -->
        <div class="price-details">
          <div class="detail-line">Seat Fare: à§³{{ selectedBus.price }}</div>
          <div class="detail-line text-green">Service Charge: à§³20 (- à§³20)</div>
          <div class="detail-line text-green">PGW Charge: à§³28 (- à§³28)</div>
          <div class="detail-line text-red">Total Discount: à§³ 48</div>
        </div>
      </div>

      <!-- Mobile Number Section -->
      <div class="mobile-section">
        <label class="section-label">MOBILE NUMBER*</label>
        <input 
          type="tel" 
          [(ngModel)]="passengerPhone" 
          name="phone"
          placeholder=""
          maxlength="11"
          class="input-field">
      </div>

      <!-- Gender Section -->
      <div class="gender-section">
        <label class="section-label">GENDER*</label>
        <select [(ngModel)]="passengerGender" name="gender" class="dropdown">
          <option value="">Select gender</option>
          <option value="Male">Male</option>
          <option value="Female">Female</option>
          <option value="Other">Other</option>
        </select>
      </div>

      <!-- Submit Button -->
      <button 
        type="submit" 
        class="btn-submit" 
        (click)="confirmBooking()"
        [disabled]="isLoading || selectedSeats.length === 0">
        {{ isLoading ? 'Processing...' : 'SUBMIT' }}
      </button>

      <!-- Password Notice -->
      <div class="password-notice">
        <span>I have already verified my phone number, and have a password.</span><br>
        <span>Login with password <a href="#">Click here</a></span>
      </div>

      <!-- Terms & Conditions -->
      <div class="terms-section">
        <label class="checkbox-label">
          <input type="checkbox" [(ngModel)]="agreedToTerms" name="terms">
          <span>By logging in you are agreeing to the <strong>Terms & Conditions</strong> and <strong>Privacy Notice</strong> of bustickets</span>
        </label>
      </div>
    </div>
  </div>
</div>

<div class="confirmation-container" *ngIf="bookingConfirmation">
  <div class="success-icon">âœ“</div>
  <h2>Booking Confirmed!</h2>
  
  <div class="alert alert-success">
    Your booking has been successfully confirmed. A confirmation email has been sent to {{ bookingConfirmation.passengerEmail }}
  </div>

  <div class="confirmation-details">
    <div class="detail-row">
      <strong>Booking Reference:</strong>
      <span class="booking-ref">{{ bookingConfirmation.bookingReference }}</span>
    </div>
    <div class="detail-row">
      <strong>Passenger Name:</strong>
      <span>{{ bookingConfirmation.passengerName }}</span>
    </div>
    <div class="detail-row">
      <strong>Bus:</strong>
      <span>{{ bookingConfirmation.busName }} ({{ bookingConfirmation.busNumber }})</span>
    </div>
    <div class="detail-row">
      <strong>Route:</strong>
      <span>{{ bookingConfirmation.source }} â†’ {{ bookingConfirmation.destination }}</span>
    </div>
    <div class="detail-row">
      <strong>Departure:</strong>
      <span>{{ formatDate(bookingConfirmation.departureTime) }} at {{ formatTime(bookingConfirmation.departureTime) }}</span>
    </div>
    <div class="detail-row">
      <strong>Seats:</strong>
      <span>{{ bookingConfirmation.seatNumbers }}</span>
    </div>
    <div class="detail-row">
      <strong>Total Amount:</strong>
      <span class="total-amount">à§³{{ bookingConfirmation.totalAmount }}</span>
    </div>
  </div>

  <div class="action-buttons">
    <button class="btn btn-primary" (click)="bookAnother()">Book Another Ticket</button>
  </div>

  <div class="note">
    <strong>Note:</strong> Please save your booking reference number. You will need it to check your booking status or for cancellation.
  </div>
</div>
