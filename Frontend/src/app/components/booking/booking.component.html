<div class="booking-container" *ngIf="!bookingConfirmation">
  <div class="booking-header">
    <h2>Complete Your Booking</h2>
    <button class="btn btn-danger" (click)="cancelBooking()">Back to Search</button>
  </div>

  <div class="bus-summary">
    <h3>{{ selectedBus.busName }} - {{ selectedBus.busType }}</h3>
    <div class="route-info">
      <span><strong>{{ selectedBus.source }}</strong></span>
      <span style="margin: 0 15px;">→</span>
      <span><strong>{{ selectedBus.destination }}</strong></span>
    </div>
    <div class="time-info">
      <span>Departure: {{ formatTime(selectedBus.departureTime) }}</span>
      <span style="margin: 0 15px;">|</span>
      <span>Arrival: {{ formatTime(selectedBus.arrivalTime) }}</span>
    </div>
  </div>

  <div *ngIf="errorMessage" class="alert alert-error">
    {{ errorMessage }}
  </div>

  <div class="seat-selection">
    <h3>Select Your Seats (Max 6)</h3>
    <div class="seat-legend">
      <div class="legend-item">
        <div class="seat-demo available"></div>
        <span>Available</span>
      </div>
      <div class="legend-item">
        <div class="seat-demo selected"></div>
        <span>Selected</span>
      </div>
      <div class="legend-item">
        <div class="seat-demo booked"></div>
        <span>Booked</span>
      </div>
    </div>

    <div class="seat-grid">
      <div 
        *ngFor="let seat of availableSeatsArray.concat(bookedSeats)" 
        class="seat"
        [class.selected]="isSeatSelected(seat)"
        [class.booked]="isSeatBooked(seat)"
        (click)="toggleSeat(seat)">
        {{ seat }}
      </div>
    </div>

    <div *ngIf="selectedSeats.length > 0" class="selected-seats-info">
      <strong>Selected Seats:</strong> {{ selectedSeats.join(', ') }}
    </div>
  </div>

  <div class="passenger-details">
    <h3>Passenger Details</h3>
    <form (ngSubmit)="confirmBooking()">
      <div class="form-group">
        <label for="name">Full Name *</label>
        <input 
          type="text" 
          id="name" 
          [(ngModel)]="passengerName" 
          name="name"
          placeholder="Enter your full name"
          required>
      </div>

      <div class="form-group">
        <label for="email">Email Address *</label>
        <input 
          type="email" 
          id="email" 
          [(ngModel)]="passengerEmail" 
          name="email"
          placeholder="Enter your email"
          required>
      </div>

      <div class="form-group">
        <label for="phone">Phone Number *</label>
        <input 
          type="tel" 
          id="phone" 
          [(ngModel)]="passengerPhone" 
          name="phone"
          placeholder="Enter 10-digit phone number"
          maxlength="10"
          required>
      </div>

      <div class="booking-summary">
        <h3>Booking Summary</h3>
        <div class="summary-item">
          <span>Number of Seats:</span>
          <span>{{ selectedSeats.length }}</span>
        </div>
        <div class="summary-item">
          <span>Price per Seat:</span>
          <span>৳{{ selectedBus.price }}</span>
        </div>
        <div class="summary-item">
          <span>Total Amount:</span>
          <span>৳{{ calculateTotal() }}</span>
        </div>
      </div>

      <button 
        type="submit" 
        class="btn btn-success btn-large" 
        [disabled]="isLoading || selectedSeats.length === 0">
        {{ isLoading ? 'Processing...' : 'Confirm Booking' }}
      </button>
    </form>
  </div>
</div>

<div class="confirmation-container" *ngIf="bookingConfirmation">
  <div class="success-icon">✓</div>
  <h2>Booking Confirmed!</h2>
  
  <div class="alert alert-success">
    Your booking has been successfully confirmed. A confirmation email has been sent to {{ bookingConfirmation.passengerEmail }}
  </div>

  <div class="confirmation-details">
    <div class="detail-row">
      <strong>Booking Reference:</strong>
      <span class="booking-ref">{{ bookingConfirmation.bookingReference }}</span>
    </div>
    <div class="detail-row">
      <strong>Passenger Name:</strong>
      <span>{{ bookingConfirmation.passengerName }}</span>
    </div>
    <div class="detail-row">
      <strong>Bus:</strong>
      <span>{{ bookingConfirmation.busName }} ({{ bookingConfirmation.busNumber }})</span>
    </div>
    <div class="detail-row">
      <strong>Route:</strong>
      <span>{{ bookingConfirmation.source }} → {{ bookingConfirmation.destination }}</span>
    </div>
    <div class="detail-row">
      <strong>Departure:</strong>
      <span>{{ formatDate(bookingConfirmation.departureTime) }} at {{ formatTime(bookingConfirmation.departureTime) }}</span>
    </div>
    <div class="detail-row">
      <strong>Seats:</strong>
      <span>{{ bookingConfirmation.seatNumbers }}</span>
    </div>
    <div class="detail-row">
      <strong>Total Amount:</strong>
      <span class="total-amount">৳{{ bookingConfirmation.totalAmount }}</span>
    </div>
  </div>

  <div class="action-buttons">
    <button class="btn btn-primary" (click)="bookAnother()">Book Another Ticket</button>
  </div>

  <div class="note">
    <strong>Note:</strong> Please save your booking reference number. You will need it to check your booking status or for cancellation.
  </div>
</div>
